---
title: CNN
date: 2024/4/7
categories:
  - 深度学习
---

## 性质

CNN（Convolve Neural Network）是一种前馈神经网络。受生物学上视觉的“感受野”机制而提出。

CNN 通常用于 CV（Computer Vision），接受的原始特征为图像。在计算机科学中，平面图像作为一个三维张量储存，对于所有的像素点，位置参数两维，颜色参数一维（一般是 RGB 三通道，也有 CMYK 四通道的）。

## 结构特点

- 局部连接，一个神经元只连接到一部分特征区域，即感受野。
- 权值共享，每个神经元使用的卷积核相同。
- 池化（pooling），池化层进行下采样，降低特征数，同时可以看作特殊的卷积。

## 卷积（Convolve）

分为三种：

1. 窄卷积，最初的卷积定义
2. 宽卷积，具有交换性
3. 等宽卷积，保持特征数量不变

卷积以后图像的大小

$$
(M-K+2P)/S+1
$$

$M$ 为原始特征数，$K$为卷积核大小，$P$ 为零填充的数目，$S$为步长。

卷积核参数的个数

$$
UVD+1
$$

每个卷积核都有 UV 个参数再加上偏置项一个参数。

### 互相关

互相关是不翻转卷积核的卷积。因为翻转是一个无用的操作，可以省略。在深度学习领域中，一般所说的卷积是互相关的卷积。

## 卷积层

卷积层之间用卷积替代全连接，原始特征的每个被卷积部分都是一个神经元的感受野，卷积后的输出经过非线性激活函数的作用后，就变成神经元的输出，因此，神经元的个数恰好为 $(M-K+2P)/S+1$.

由于图像通常是一个三维张量，卷积核的深度也需要与特征的深度相同，才能同时对三个通道的特征进行采样。

如果同时使用多种卷积核，就需要再增加一个维度，因此实际应用中，卷积核通常是 4 维的，每个切片都是一个三维的卷积核。

## 汇聚（池化）层

池化层使用特殊的卷积核，一般为 2x2 的卷积核，有最大汇聚和平均汇聚两种。

最大汇聚即取神经元的感受野中最大的数作为输出，平均汇聚即取神经元的感受野中所有数的平均值作为输出。

不过在现代的 CNN 中，池化层的使用越来越少，因为其作用可以被卷积层完全替代，很多时候为全卷积层。

## 全连接层

经过卷积和池化后的图像特征相比原始特征已经简单了许多，这时就可以使用全连接神经网络进行分类操作。

## 误差和反向传播
