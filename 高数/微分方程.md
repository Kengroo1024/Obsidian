## 可分离变量的方程

可以被表示为$g(x)\mathrm dy=f(x)\mathrm dx$的方程

求解方法：两边积分

$$
\int g(y)\mathrm dy=\int f(x)\mathrm dx
$$

## 齐次微分方程

可以被表示为$\dfrac{\mathrm dy}{\mathrm dx}=\varphi(\dfrac yx)$的方程

求解方法：令$u=\dfrac yx$，有$y'=u+xu'$，则原方程可以化为

$$
xu'=\varphi(u)-u
$$

进一步可以化为

$$
\dfrac{\mathrm dx}{x}=\dfrac{\mathrm du}{\varphi(u)-u}
$$

于是归结为可分离变量的方程。

## 一阶线性微分方程

形如$y'+p(x)y=q(x)$的方程

求解方法：公式法

$$
y=
\mathrm e^{-\int p(x)\mathrm dx}
\left[
\int q(x)\mathrm e^{\int p(x)\mathrm dx}\mathrm dx+C
\right]
$$

括号内都是正的，括号外都是负的，e的指数上都是$p$，常数项才有$q$.

## 线性微分方程解的结构

>[!note]
> 可以和线性方程组解的结构类比证明和记忆。

$n$阶线性微分方程的一般形式为

$$
y^{(n)}+\sum_{i=1}^{n} p_{i}(x)y^{(n-i)}=q(x)
$$

规定$y^{(0)}=y$. 当$f(x)=0$时称为$n$阶齐次线性微分方程。

在此特别研究二阶线性微分方程。

二阶齐次线性方程

$$
y''+p(x)y'+q(x)y=0
$$

二阶非齐次线性方程

$$
y''+p(x)y'+q(x)y=f(x)
$$

### 齐次方程

如果$y_1(x)$和$y_2(x)$是齐次方程的两个线性无关[^1]的特解，那么

$$
y=C_1y_1(x)+C_2y_2(x)
$$

[^1]: 线性无关即不成比例

就是齐次方程的通解。

### 非齐次方程

如果如果$y_1(x)$和$y_2(x)$是齐次方程的两个线性无关的特解，$y^*(x)$是非齐次方程的特解，那么

$$
y=C_1y_1(x)+C_2y_2(x)+y^*(x)
$$

是非齐次方程的通解。

### 拆分非齐次方程

如果$y_1^*(x),y_2^*(x)$分别是非齐次线性方程

$$
\begin{aligned}
y''+p(x)y'+q(x)y=f_1(x)\\
y''+p(x)y'+q(x)y=f_2(x)
\end{aligned}
$$

的通解，那么$y_1^*(x)+y_2^*(x)$是非齐次线性方程

$$
y''+p(x)y'+q(x)y=f_1(x)+f_2(x)
$$

的一个特解。

## 常系数线性微分方程

### 常系数齐次线性方程

采用特征根法求解，以二阶为例。

二阶常系数齐次微分方程一般形式为

$$
y''+py'+q=0
$$

特征方程为

$$
r^2+pr+q=0
$$

设$r_1,r_2$为该方程的两个根。

1. $r_1\not= r_2$，且都是实数，通解为

    $$
    y=C_1\mathrm e^{r_1x}+C_2\mathrm e^{r_2x}
    $$

2. $r_1=r_2$，通解为

    $$
    y=(C_1+C_2x)\mathrm e^{r_1x}
    $$

3. $r_1=a+\mathrm ib,\ r_2=a-\mathrm ib$为共轭复根，通解为

    $$
    y=\mathrm e^{ax}(C_1\cos bx+C_2\sin bx)
    $$

其实还是

$$
y=\sum_{i=1}^n \mathrm C_ie^{r_i}
$$

只是有复数时要用欧拉公式展开。

### 二阶常系数非齐次线性方程

二阶常系数非齐次微分方程一般形式为

$$
y''+py'+q=f(x)
$$

1. 若$f(x)=P_m(x)e^{\lambda x}$，其中$P_m(x)$为$x$的$m$次多项式，$\lambda$为特征方程的一个根，那么特解可以表示为

    $$
    y^*(x)=x^kQ_m(x)\mathrm e^{\lambda x}
    $$

    其中$k$是$\lambda$的重数，$Q_m(x)$是与$P_m(x)$同次的多项式。

1. 若$$f(x)=\mathrm e^{ax}[P_l^{(1)}(x)\cos bx+P_n^{(2)}(x)\sin bx]$$其中$P_l^{(1)},P_n^{(2)}$分别是$x$的$l,n$次多项式，则特解可以表示为

    $$
    y^*(x)=x^k\mathrm e^{ax}[R_m^{(1)}(x)\cos bx+R_m^{(2)}(x)\sin bx]
    $$

    其中$R_m^{(1)}(x),R_m^{(2)}(x)$是两个$m$次多项式，$m=\max\{n,l\}$.

    $$
    k=\left\{\begin{aligned}
    0&,a+\mathrm ib\text{不是特征方程的根}\\
    1&,a+\mathrm ib\text{是特征方程的单根}
    \end{aligned}\right.
    $$

## 差分方程

函数$f(x)$定义在数列$\{a_n\}$上，令$y_n=f(x_n)$，定义$\Delta$为差分算子，即$\Delta y_n=y_n-y_{n-1}$.

称形如

$$
F(x_n,\Delta y_n,\Delta^2 y_n,...,\Delta^n y_n)=0
$$

的含有因变量的差分的方程为差分方程。

把数列看成定义在自然数子集上的函数，可以看出差分方程和递推关系完全等价。

### 解差分方程

>[!note]- 递推关系和常系数线性微分方程的联系
>
> 微分可以看作特殊的差分过程，作为差分在连续统上的一种推广。一阶线性微分方程可以通过离散化精确地写成递推关系的形式。
>
> 更详细可以看[Wiki](https://en.wikipedia.org/wiki/Recurrence_relation#Relationship_to_differential_equations)

$$
u_n=\sum_{i=1}^k a_iu_{n-i}+f(n)
$$

称为$k$阶常系数递推关系。

使用特征根法解上面的递推关系。

### 特征根法

将递推关系式

$$
u_n-a_1u_{n-1}-a_2u_{n-2}-...-a_k-u_{n-k}=0
$$

改写为如下的特征方程

$$
x^k-a_1x^{k-1}-...-a_{k-1}x-a_k=0
$$

有如下定理

1. 设$q\in C$且$q\not=0$，$u_n=q^n$是递推关系的一个解当且仅当$q$是特征方程的一个根。$q$称为递推关系的一个$m$重特征根，当$q$是特征方程的$m$重根，简称特征根。
2. 设$g_i(n)$都是递推关系的解，那么它们的线性组合也是递推关系的解
3. 如果递推关系有$k$个彼此相异的特征根$q_1,q_2,...,q_k$，那么

    $$
    u_n=c_1q_1^n+c_2q_2^n+...+c_kq_k^n
    $$

    是递推关系的通解。

#### 有重根时的常系数线性齐次递推关系解法

设$q$是递推关系的一个$m$重特征根，那么

$$
u_n=n^jq^n,j=0,1,2,...,m-1
$$

都是递推关系的解。

设递推关系有$t$个相异的特征根$q_1,q_2,...,q_t$，其中$q_i$是$e_i$重根，$i=1,2,...,t$. 令

$$
h_i(n)=c_{i1}+c_{i2}n+...+c_{ie_i}n^{e_i-1}
$$

那么递推关系的通解为

$$
u_n=h_1(n)q_1^n+h_2(n)q_2^n+...+h_t(n)q_t^n
$$

#### 两类特殊常系数非齐次线性递推关系的解

1. $f(n)$是$n$的$m$次多项式，如果1是递推关系的$i$重特征根（如果不是特征根那么按0重计算）那么$n^ig(n)$是递推关系的一个特解，其中$g(n)$是一个$m$次多项式，系数应通过待定系数法解出。
2. $f(n)=c\cdot a^n$，其中$c,a$均为非零常数。如果$a$是递推关系的$i$重特征根（如果不是特征根那么按0重计算）那么$A\cdot n^ia^n$是递推关系的一个特解，其中系数$A$应通过待定系数法解出。

### 参考

华南理工大学出版社《组合数学》曹汝成，第三章第二节，递推关系
